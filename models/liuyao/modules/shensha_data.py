"""
神煞数据模块 - 提供六爻神煞数据和查询功能
"""

from typing import Dict, List, Tuple, Optional

# 年神煞数据
YEAR_SHENSHA = {
    "子": [("岁破", 6), ("太岁", 1), ("天德", 3)],
    "丑": [("岁破", 5), ("太岁", 2), ("天德", 4)],
    "寅": [("岁破", 4), ("太岁", 3), ("天德", 5)],
    "卯": [("岁破", 3), ("太岁", 4), ("天德", 6)],
    "辰": [("岁破", 2), ("太岁", 5), ("天德", 1)],
    "巳": [("岁破", 1), ("太岁", 6), ("天德", 2)],
    "午": [("岁破", 6), ("太岁", 1), ("天德", 3)],
    "未": [("岁破", 5), ("太岁", 2), ("天德", 4)],
    "申": [("岁破", 4), ("太岁", 3), ("天德", 5)],
    "酉": [("岁破", 3), ("太岁", 4), ("天德", 6)],
    "戌": [("岁破", 2), ("太岁", 5), ("天德", 1)],
    "亥": [("岁破", 1), ("太岁", 6), ("天德", 2)]
}

# 月神煞数据
MONTH_SHENSHA = {
    "子": [("月建", 1), ("月破", 6), ("月煞", 3)],
    "丑": [("月建", 2), ("月破", 5), ("月煞", 4)],
    "寅": [("月建", 3), ("月破", 4), ("月煞", 5)],
    "卯": [("月建", 4), ("月破", 3), ("月煞", 6)],
    "辰": [("月建", 5), ("月破", 2), ("月煞", 1)],
    "巳": [("月建", 6), ("月破", 1), ("月煞", 2)],
    "午": [("月建", 1), ("月破", 6), ("月煞", 3)],
    "未": [("月建", 2), ("月破", 5), ("月煞", 4)],
    "申": [("月建", 3), ("月破", 4), ("月煞", 5)],
    "酉": [("月建", 4), ("月破", 3), ("月煞", 6)],
    "戌": [("月建", 5), ("月破", 2), ("月煞", 1)],
    "亥": [("月建", 6), ("月破", 1), ("月煞", 2)]
}

# 日神煞数据
DAY_SHENSHA = {
    "子": [("日建", 1), ("日破", 6), ("日刑", 3), ("日合", 4)],
    "丑": [("日建", 2), ("日破", 5), ("日刑", 4), ("日合", 3)],
    "寅": [("日建", 3), ("日破", 4), ("日刑", 5), ("日合", 2)],
    "卯": [("日建", 4), ("日破", 3), ("日刑", 6), ("日合", 1)],
    "辰": [("日建", 5), ("日破", 2), ("日刑", 1), ("日合", 6)],
    "巳": [("日建", 6), ("日破", 1), ("日刑", 2), ("日合", 5)],
    "午": [("日建", 1), ("日破", 6), ("日刑", 3), ("日合", 4)],
    "未": [("日建", 2), ("日破", 5), ("日刑", 4), ("日合", 3)],
    "申": [("日建", 3), ("日破", 4), ("日刑", 5), ("日合", 2)],
    "酉": [("日建", 4), ("日破", 3), ("日刑", 6), ("日合", 1)],
    "戌": [("日建", 5), ("日破", 2), ("日刑", 1), ("日合", 6)],
    "亥": [("日建", 6), ("日破", 1), ("日刑", 2), ("日合", 5)]
}

# 时神煞数据
HOUR_SHENSHA = {
    "子": [("时建", 1), ("时破", 6), ("黄幕", 4)],
    "丑": [("时建", 2), ("时破", 5), ("黄幕", 3)],
    "寅": [("时建", 3), ("时破", 4), ("黄幕", 2)],
    "卯": [("时建", 4), ("时破", 3), ("黄幕", 1)],
    "辰": [("时建", 5), ("时破", 2), ("黄幕", 6)],
    "巳": [("时建", 6), ("时破", 1), ("黄幕", 5)],
    "午": [("时建", 1), ("时破", 6), ("黄幕", 4)],
    "未": [("时建", 2), ("时破", 5), ("黄幕", 3)],
    "申": [("时建", 3), ("时破", 4), ("黄幕", 2)],
    "酉": [("时建", 4), ("时破", 3), ("黄幕", 1)],
    "戌": [("时建", 5), ("时破", 2), ("黄幕", 6)],
    "亥": [("时建", 6), ("时破", 1), ("黄幕", 5)]
}

# 六神对应表
LIUSHEN_MAP = {
    "甲": ["青龙", "朱雀", "勾陈", "腾蛇", "白虎", "玄武"],
    "乙": ["青龙", "朱雀", "勾陈", "腾蛇", "白虎", "玄武"],
    "丙": ["朱雀", "勾陈", "腾蛇", "白虎", "玄武", "青龙"],
    "丁": ["朱雀", "勾陈", "腾蛇", "白虎", "玄武", "青龙"],
    "戊": ["勾陈", "腾蛇", "白虎", "玄武", "青龙", "朱雀"],
    "己": ["勾陈", "腾蛇", "白虎", "玄武", "青龙", "朱雀"],
    "庚": ["腾蛇", "白虎", "玄武", "青龙", "朱雀", "勾陈"],
    "辛": ["腾蛇", "白虎", "玄武", "青龙", "朱雀", "勾陈"],
    "壬": ["白虎", "玄武", "青龙", "朱雀", "勾陈", "腾蛇"],
    "癸": ["白虎", "玄武", "青龙", "朱雀", "勾陈", "腾蛇"]
}

# 六神解释
LIUSHEN_DESC = {
    "青龙": "吉神，主文昌、官禄、贵人",
    "朱雀": "凶神，主口舌、争端、官司",
    "勾陈": "平神，主阻隔、停滞、疑惑",
    "腾蛇": "凶神，主变动、口舌、是非",
    "白虎": "凶神，主伤灾、损失、斗争",
    "玄武": "凶神，主盗贼、暗算、隐私"
}

def get_shensha_by_zhi(year_zhi: str, month_zhi: str, day_zhi: str, hour_zhi: str) -> Dict:
    """
    根据四柱地支获取神煞信息
    
    参数:
        year_zhi (str): 年柱地支
        month_zhi (str): 月柱地支
        day_zhi (str): 日柱地支
        hour_zhi (str): 时柱地支
        
    返回:
        Dict: 包含年、月、日、时四组神煞信息的字典
    """
    result = {
        "year": YEAR_SHENSHA.get(year_zhi, []),
        "month": MONTH_SHENSHA.get(month_zhi, []),
        "day": DAY_SHENSHA.get(day_zhi, []),
        "hour": HOUR_SHENSHA.get(hour_zhi, [])
    }
    return result

def get_liushen(day_gan: str) -> List[str]:
    """
    根据日干获取六神序列
    
    参数:
        day_gan (str): 日干
        
    返回:
        List[str]: 六神列表，从初爻到六爻
    """
    return LIUSHEN_MAP.get(day_gan, ["青龙", "朱雀", "勾陈", "腾蛇", "白虎", "玄武"])

def get_liushen_desc(liushen: str) -> str:
    """
    获取六神解释
    
    参数:
        liushen (str): 六神名称
        
    返回:
        str: 六神解释
    """
    return LIUSHEN_DESC.get(liushen, "未知神煞")
