"""
六十四卦信息模块 - 提供六十四卦的名称、含义和解释
"""

class SixtyFourGuaInfo:
    """六十四卦信息类，提供卦象的基本含义和解释"""
    
    def __init__(self):
        """初始化六十四卦信息"""
        
        # 八宫卦序与六十四卦名称
        self.bagong_sequence = {
            # 乾宫八卦
            "乾宫": ["乾为天", "天风姤", "天山遁", "天地否", "风地观", "山地剥", "火地晋", "火天大有"],
            
            # 坎宫八卦
            "坎宫": ["坎为水", "水泽节", "水雷屯", "水火既济", "泽火革", "雷火丰", "地火明夷", "地水师"],
            
            # 艮宫八卦
            "艮宫": ["艮为山", "山火贲", "山天大畜", "山泽损", "火泽睽", "天泽履", "风泽中孚", "风山渐"],
            
            # 震宫八卦
            "震宫": ["震为雷", "雷地豫", "雷水解", "雷风恒", "地风升", "水风井", "泽风大过", "泽雷随"],
            
            # 巽宫八卦
            "巽宫": ["巽为风", "风天小畜", "风火家人", "风雷益", "天雷无妄", "火雷噬嗑", "山雷颐", "山风蛊"],
            
            # 离宫八卦
            "离宫": ["离为火", "火山旅", "火风鼎", "火水未济", "山水蒙", "风水涣", "天水讼", "天火同人"],
            
            # 坤宫八卦
            "坤宫": ["坤为地", "地雷复", "地泽临", "地天泰", "雷天大壮", "泽天夬", "水天需", "水地比"],
            
            # 兑宫八卦
            "兑宫": ["兑为泽", "泽水困", "泽地萃", "泽山咸", "水山蹇", "地山谦", "雷山小过", "雷泽归妹"]
        }
        
        # 八宫所属的上卦
        self.bagong_upper = {
            "乾宫": "乾", "坎宫": "坎", "艮宫": "艮", "震宫": "震",
            "巽宫": "巽", "离宫": "离", "坤宫": "坤", "兑宫": "兑"
        }
        
        # 六十四卦对应的八宫
        self.gua_to_bagong = {}
        for gong, guas in self.bagong_sequence.items():
            for gua in guas:
                self.gua_to_bagong[gua] = gong
        
        # 六十四卦编码映射（上卦-下卦对应卦名）
        self.encode_to_gua = {
            # 乾宫八卦
            "乾乾": "乾为天", "乾巽": "天风姤", "乾艮": "天山遁", "乾坤": "天地否", 
            "巽坤": "风地观", "艮坤": "山地剥", "离坤": "火地晋", "离乾": "火天大有",
            
            # 坎宫八卦
            "坎坎": "坎为水", "坎兑": "水泽节", "坎震": "水雷屯", "坎离": "水火既济", 
            "兑离": "泽火革", "震离": "雷火丰", "坤离": "地火明夷", "坤坎": "地水师",
            
            # 艮宫八卦
            "艮艮": "艮为山", "艮离": "山火贲", "艮乾": "山天大畜", "艮兑": "山泽损", 
            "离兑": "火泽睽", "乾兑": "天泽履", "巽兑": "风泽中孚", "巽艮": "风山渐",
            
            # 震宫八卦
            "震震": "震为雷", "震坤": "雷地豫", "震坎": "雷水解", "震巽": "雷风恒", 
            "坤巽": "地风升", "坎巽": "水风井", "兑巽": "泽风大过", "兑震": "泽雷随",
            
            # 巽宫八卦
            "巽巽": "巽为风", "巽乾": "风天小畜", "巽离": "风火家人", "巽震": "风雷益", 
            "乾震": "天雷无妄", "离震": "火雷噬嗑", "艮震": "山雷颐", "艮巽": "山风蛊",
            
            # 离宫八卦
            "离离": "离为火", "离艮": "火山旅", "离巽": "火风鼎", "离坎": "火水未济", 
            "艮坎": "山水蒙", "巽坎": "风水涣", "乾坎": "天水讼", "乾离": "天火同人",
            
            # 坤宫八卦
            "坤坤": "坤为地", "坤震": "地雷复", "坤兑": "地泽临", "坤乾": "地天泰", 
            "震乾": "雷天大壮", "兑乾": "泽天夬", "坎乾": "水天需", "坎坤": "水地比",
            
            # 兑宫八卦
            "兑兑": "兑为泽", "兑坎": "泽水困", "兑坤": "泽地萃", "兑艮": "泽山咸", 
            "坎艮": "水山蹇", "坤艮": "地山谦", "震艮": "雷山小过", "震兑": "雷泽归妹"
        }
        
        # 卦名对应编码
        self.gua_to_encode = {v: k for k, v in self.encode_to_gua.items()}
        
        # 六十四卦基本含义
        self.gua_meanings = {
            # 乾宫八卦
            "乾为天": "刚健、自强不息、领导力、创造力",
            "天风姤": "相遇、交合、外强内弱、阴阳相遇",
            "天山遁": "退隐、逃避、避险、韬光养晦",
            "天地否": "闭塞、不通、背离、艰难",
            "风地观": "观察、视察、审视、展示",
            "山地剥": "剥落、衰败、削弱、渐变",
            "火地晋": "进升、上进、晋升、发展",
            "火天大有": "丰盛、充实、大大拥有、昌盛",
            
            # 坎宫八卦
            "坎为水": "险难、陷阱、机智、隐藏",
            "水泽节": "节制、约束、规范、限度",
            "水雷屯": "初始、困难、聚集、储备",
            "水火既济": "完成、成功、平衡、和谐",
            "泽火革": "革新、变革、改变、更新",
            "雷火丰": "丰富、充足、盛大、隆重",
            "地火明夷": "受伤、损害、暗昧、隐匿",
            "地水师": "众人、军队、纪律、集体行动",
            
            # 艮宫八卦
            "艮为山": "稳重、停止、限制、沉静",
            "山火贲": "文饰、装饰、美化、充实",
            "山天大畜": "蓄积、储存、涵养、蕴藏",
            "山泽损": "损失、付出、减少、牺牲",
            "火泽睽": "背离、乖违、分离、对立",
            "天泽履": "履行、践行、谨慎、礼节",
            "风泽中孚": "诚信、忠诚、信任、中正",
            "风山渐": "渐进、逐步、进退有序、循序渐进",
            
            # 震宫八卦
            "震为雷": "震动、行动、惊醒、生发",
            "雷地豫": "愉悦、喜悦、舒适、和顺",
            "雷水解": "解除、化解、释放、消除",
            "雷风恒": "恒久、坚持、持久、稳定",
            "地风升": "上升、提高、升华、发展",
            "水风井": "汲取、补给、不竭、生生不息",
            "泽风大过": "过度、过头、失衡、超越常规",
            "泽雷随": "跟随、顺从、适应、依附",
            
            # 巽宫八卦
            "巽为风": "柔顺、谦逊、渗透、顺从",
            "风天小畜": "蓄养、收敛、积累、涵养",
            "风火家人": "家庭、亲人、和睦、团结",
            "风雷益": "增益、有利、互利、促进",
            "天雷无妄": "无妄、自然、无为、坦率",
            "火雷噬嗑": "咬合、决断、刚断、分析",
            "山雷颐": "养育、修养、培育、滋养",
            "山风蛊": "蛊惑、整治、振作、革新",
            
            # 离宫八卦
            "离为火": "光明、明朗、附着、美丽",
            "火山旅": "旅行、漂泊、客居、变动",
            "火风鼎": "革故鼎新、稳固、烹饪、变化",
            "火水未济": "未完成、未竟、尚待努力、前途有艰难",
            "山水蒙": "蒙昧、启蒙、初学、发蒙",
            "风水涣": "分散、散开、涣散、解散",
            "天水讼": "争讼、争辩、诉讼、冲突",
            "天火同人": "同类、亲近、和同、团结",
            
            # 坤宫八卦
            "坤为地": "包容、顺从、厚德载物、柔顺",
            "地雷复": "复苏、复兴、回归、重新开始",
            "地泽临": "临近、监督、治理、管理",
            "地天泰": "通泰、和平、顺利、亨通",
            "雷天大壮": "强壮、壮大、刚健、强盛",
            "泽天夬": "决断、果断、分决、决绝",
            "水天需": "等待、需求、期望、盼望",
            "水地比": "比类、亲比、辅助、比邻",
            
            # 兑宫八卦
            "兑为泽": "喜悦、欢乐、愉快、满足",
            "泽水困": "困境、围困、限制、束缚",
            "泽地萃": "聚集、集合、汇聚、团聚",
            "泽山咸": "感应、感化、交感、和谐",
            "水山蹇": "艰难、跛行、困难、险阻",
            "地山谦": "谦虚、谦逊、自谦、退让",
            "雷山小过": "小过、略过、轻微过失、小心谨慎",
            "雷泽归妹": "归宿、归依、女子出嫁、成家"
        }
        
        # 卦爻辞解释（简化版）
        self.gua_interpretations = {
            # 样例卦爻辞解释（简化版，实际应有详细的卦爻辞）
            "乾为天": {
                "卦辞": "元亨利贞。",
                "卦辞解释": "大吉大利、刚健、坚持正道。",
                "爻辞": {
                    "初九": "潜龙勿用。",
                    "九二": "见龙在田，利见大人。",
                    "九三": "君子终日乾乾，夕惕若，厉无咎。",
                    "九四": "或跃在渊，无咎。",
                    "九五": "飞龙在天，利见大人。",
                    "上九": "亢龙有悔。",
                    "用九": "见群龙无首，吉。"
                },
                "爻辞解释": {
                    "初九": "潜伏隐藏，暂时不宜行动。",
                    "九二": "龙现于田野，有利于见大人。",
                    "九三": "君子整日勤勉不懈，夜晚仍警惕戒慎，虽有危险但无灾祸。",
                    "九四": "或跃入深渊，无灾祸。",
                    "九五": "龙飞上天，有利于见大人。",
                    "上九": "龙飞太高，骄傲自满，有悔恨。",
                    "用九": "看到群龙无首领，吉祥。"
                }
            },
            "坤为地": {
                "卦辞": "元亨，利牝马之贞。君子有攸往，先迷后得主，利西南得朋，东北丧朋。安贞吉。",
                "卦辞解释": "大吉大利，有利于雌马般的柔顺。君子有所前往，先迷后得到主人，有利于西南方向获得朋友，东北方向失去朋友。安守正道则吉祥。",
                "爻辞": {
                    "初六": "履霜，坚冰至。",
                    "六二": "直方大，不习无不利。",
                    "六三": "含章可贞，或从王事，无成有终。",
                    "六四": "括囊，无咎无誉。",
                    "六五": "黄裳，元吉。",
                    "上六": "龙战于野，其血玄黄。",
                    "用六": "利永贞。"
                },
                "爻辞解释": {
                    "初六": "踏霜而行，坚冰将至。",
                    "六二": "正直方正，没有不利。",
                    "六三": "包含美德可以正固，或者从事王事，虽无成就但有结果。",
                    "六四": "扎紧口袋，无灾祸无称誉。",
                    "六五": "穿黄色衣裳，大吉。",
                    "上六": "龙战于旷野，血色玄黄。",
                    "用六": "有利于永远守正。"
                }
            }
            # 其余卦爻辞解释应按实际需求补充
        }
    
    def get_gua_name(self, upper_gua: str, lower_gua: str) -> str:
        """
        根据上下卦获取卦名
        
        参数:
            upper_gua (str): 上卦名称
            lower_gua (str): 下卦名称
            
        返回:
            str: 卦名
        """
        encode = f"{upper_gua}{lower_gua}"
        return self.encode_to_gua.get(encode, f"{upper_gua}{lower_gua}卦")
    
    def get_gua_encode(self, gua_name: str) -> str:
        """
        根据卦名获取上下卦编码
        
        参数:
            gua_name (str): 卦名
            
        返回:
            str: 上下卦编码
        """
        return self.gua_to_encode.get(gua_name, "")
    
    def get_bagong(self, gua_name: str) -> str:
        """
        获取卦所属的八宫
        
        参数:
            gua_name (str): 卦名
            
        返回:
            str: 所属八宫
        """
        return self.gua_to_bagong.get(gua_name, "")
    
    def get_gua_meaning(self, gua_name: str) -> str:
        """
        获取卦的基本含义
        
        参数:
            gua_name (str): 卦名
            
        返回:
            str: 卦的基本含义
        """
        return self.gua_meanings.get(gua_name, "未知含义")
    
    def get_gua_interpretation(self, gua_name: str) -> dict:
        """
        获取卦的详细解释（包括卦辞和爻辞）
        
        参数:
            gua_name (str): 卦名
            
        返回:
            dict: 卦的详细解释
        """
        return self.gua_interpretations.get(gua_name, {"卦辞": "暂无解释", "爻辞": {}})
    
    def get_all_guas_in_bagong(self, bagong: str) -> list:
        """
        获取某八宫中的所有卦
        
        参数:
            bagong (str): 八宫名称
            
        返回:
            list: 该八宫中的所有卦名
        """
        return self.bagong_sequence.get(bagong, [])

# 单例模式，导出一个实例
sixtyfour_gua_info = SixtyFourGuaInfo()
